---
- hosts: localhost
  gather_facts: false
  remote_user: core
  vars:
    motioncore_ip: "192.168.200.15"
  roles:
    #- rpi4_coreos
    - motioncore_podman
- hosts: "192.168.200.15"
  remote_user: core
  become: yes
  roles:
    - devsec.hardening.os_hardening # requires python3-rpm on the remote host
    - devsec.hardening.ssh_hardening
  vars:
    os_auditd_enabled: false
    os_immutable_fs: true

# set rpi4_coreos_ip in vars/main.yaml and run following command for non interactive run
# if you know what the ip address will be and want to avoid ssh_known check (insecure!)
# ansible-playbook motioncore_pb.yaml --ask-become-pass --ssh-common-args='-o StrictHostKeyChecking=no'